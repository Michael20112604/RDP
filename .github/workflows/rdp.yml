@echo off
echo æ­£åœ¨å¯åŠ¨ Windows Cloud Desktop...

:: è®¾ç½®è¿œç¨‹æ¡Œé¢å¯†ç ï¼ˆä½ å¯ä»¥æ”¹æˆä½ å–œæ¬¢çš„ï¼‰
net user runneradmin YourPassword123

:: ä¸‹è½½å¹¶è§£å‹ ngrok
curl -Lo ngrok.zip https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-stable-windows-amd64.zip
powershell -Command "Expand-Archive ngrok.zip -DestinationPath ."
del ngrok.zip

:: æ³¨å…¥ ngrok tokenï¼ˆæ¥è‡ª GitHub Secretsï¼‰
ngrok.exe config add-authtoken %NGROK_AUTH_TOKEN%

:: å¯åŠ¨ ngrok éš§é“ï¼ˆç›‘å¬ RDP ç«¯å£ 3389ï¼‰
start /b ngrok.exe tcp 3389

echo ç­‰å¾… ngrok å¯åŠ¨...
timeout /t 15 >nul

:: è·å– ngrok åˆ†é…çš„å…¬ç½‘åœ°å€
curl -s http://127.0.0.1:4040/api/tunnels > tunnel.json
type tunnel.json

echo.
echo âœ… è¯·åœ¨è¾“å‡ºæ—¥å¿—ä¸­æŸ¥æ‰¾ tcp://x.tcp.ngrok.io:xxxxx åœ°å€
echo ğŸ–¥ï¸ æ‰“å¼€è¿œç¨‹æ¡Œé¢ (mstsc)ï¼Œè¾“å…¥è¯¥åœ°å€è¿æ¥
echo ğŸ”‘ ç”¨æˆ·å: runneradmin
echo ğŸ” å¯†ç : YourPassword123
echo.

pause
